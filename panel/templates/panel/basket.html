{% load static %}
{% load money_converter %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="{% static 'css/basket.css' %}"/>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>سبد خرید </title>
</head>
<body>
<div class="wrapper">
    <nav dir="rtl">
        <div dir="rtl" class="links">
            <a href="{% url 'home:home' %}">خانه</a>
            <a href="{% url 'course:course' %}">دوره ها</a>
            <a href="">کتابخانه</a>
        </div>

        <div class="leftSide">
            اندیشه پارسیان
        </div>
        <div class="mob">
            <button onclick="dropdown2()" class="dropDownButton">
                پنل کاربری
            </button>
            <div>
                <a href="{% url 'panel:course' %}" class="dropDownLinks">دوره ها</a>
            </div>
            <div>
                <a href="{% url 'panel:lastOrder' %}" class="dropDownLinks"
                >تراکنش های اخیر</a
                >
            </div>
            <div><a href="{% url 'panel:basket' %}" class="dropDownLinks">سبد خرید</a></div>
            {% if request.user.user_student.is_information_submited %}
                <div class="SideCard"><a href="{% url 'panel:showInfo' %}">اطلاعات کاربر</a></div>
            {% else %}
                <div class="SideCard"><a href="{% url 'panel:userInfo' %}">تکمیل اطلاعات کاربری</a></div>
            {% endif %}
        </div>
    </nav>
    <aside>
        <div>
            <img src="{% static 'images/account.png' %}" alt=""/>
            {% if request.user.first_name %}
                <h1>{{ request.user.first_name }}</h1>
            {% else %}
                <h1>{{ request.user.user_student.username }}</h1>
            {% endif %}
            <a href="" class="change">ویرایش اکانت</a>
            <div class="SideCard">
                <a href="{% url 'panel:course' %}">دوره ها</a>
            </div>
            <div class="SideCard">
                <a href="{% url 'panel:lastOrder' %}">تراکنش های اخیر</a>
            </div>
            <div class="SideCard Active"><a href="{% url 'panel:basket' %}">سبد خرید</a></div>
            {% if request.user.user_student.is_information_submited %}
                <div class="SideCard"><a href="{% url 'panel:showInfo' %}">اطلاعات کاربر</a></div>
            {% else %}
                <div class="SideCard"><a href="{% url 'panel:userInfo' %}">تکمیل اطلاعات کاربری</a></div>
            {% endif %}
            {% if request.user.user_student.super_student_user %}
                <div class="SideCard"><a href="">ثبت نام در مدرسه</a></div>
                {% comment %}   todo --> change href and create panel for that
                {% endcomment %}
            {% endif %}

            <br>
            <br>
            <br>
            <div class="SideCard Active" style="background-color: #ff3939"><a style="color: white;font-weight: bold"
                                                                              href="{% url 'account:logout' %}">خروج</a>
            </div>
        </div>
    </aside>
    <div class="MainContent">
        <main>
            <div>
                <h1>سبد خرید</h1>
                <table dir="rtl">
                    <tr>
                        <th>نام آیتم</th>
                        <th>نام استاد</th>
                        <th>قیمت اصلی</th>
                        <th>قیمت با تخفیف</th>
                        <th>تعداد</th>
                        <th>عملیات</th>
                    </tr>
                    {% for basket in baskets %}
                        <tr>
                            </td>
                            <td>{{ basket.course_name }}</td>
                            <td>{{ basket.teacher }}</td>
                            <td>{{ basket.price|money }}</td>
                            <td>{{ basket.price_with_off|money }}</td>
                            <td>1</td>
                            <td>
                                <button class="add-btn">+</button>
                                <button class="remove-btn">-</button>
                                <button class="delete-btn">حذف</button>
                            </td>
                        </tr>
                    {% endfor %}


                </table>
            </div>
        </main>
        <div class="Sabad">
            <div>
                <h1><span>77700</span>قیمت دوره ها</h1>
            </div>
            <div class="sood">
                <div class="text"><p>سود شما</p></div>
                <div class="sale"><p>5000</p></div>
            </div>
            <div>
                <h1>قابل پرداخت</h1>
                <h2>199,000</h2>
                <form>
                    <button type="submit">پرداخت</button>
                    <label for="codeTakhfif">کد تخفیف</label>
                    <input type="text" id="codeTakhfif" name="codeTakhfif"/>
                </form>
            </div>
        </div>
    </div>
</div>
<script src="{% static 'JS/basket.js' %}"></script>
<script>
    // Function to increase the count of a course
    function increaseCount(btn) {
        // Get the parent row of the button
        const row = btn.closest("tr");
        // Find the count element within the row
        const countElement = row.querySelector(".count");
        // Get the current count value
        let count = parseInt(countElement.textContent);
        // Increase the count by 1
        count++;
        // Update the count element with the new value
        countElement.textContent = count;
    }

    // Function to decrease the count of a course
    function decreaseCount(btn) {
        // Get the parent row of the button
        const row = btn.closest("tr");
        // Find the count element within the row
        const countElement = row.querySelector(".count");
        // Get the current count value
        let count = parseInt(countElement.textContent);
        // Ensure count is greater than 0 before decreasing
        if (count > 0) {
            // Decrease the count by 1
            count--;
            // Update the count element with the new value
            countElement.textContent = count;
        }
    }

    // Add event listeners to the buttons
    document.querySelectorAll(".add-btn").forEach(button => {
        button.addEventListener("click", function () {
            increaseCount(this);
        });
    });

    document.querySelectorAll(".remove-btn").forEach(button => {
        button.addEventListener("click", function () {
            decreaseCount(this);
        });
    });
</script>
</body>
</html>
